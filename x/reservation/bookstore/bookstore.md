# bookmanageについて
======================

## 受け入れ要件
/bookstoreパスにアクセスされた際に本の管理機能を実行する。
なお、受け取るデータはclient側でvalidateチェックを受けていることを前提としている。
2019.4.8時点で必要な必須機能は以下の通り。
- 本の検索機能
    - 検索条件なし
        - 検索結果として、登録されている全ての本の情報を返す
    - タイトル指定
        - 検索結果として、条件に該当するタイトルを含む本の情報を返す
- 本の追加機能
    - 本のタイトルとラベルを指定すると、本が登録される
- 登録されている本の情報更新
    - 本のIDを指定して、本のラベルを更新する
- 登録している本の削除
    - 本のIDを指定して本の登録情報を削除する

## テスト文章
- [] /bookmanage/にGETアクセスすると本の情報が取得される
    - [] 条件指定なしでDB接続ができた場合は登録されている全ての本の情報を返す
        - [] 対象が存在しなければ返り値として200ステータスとMsgを返す
    - [] /bookmanage/:titleでtitle指定してDB接続ができた場合は登録されている全ての本の情報を返す
        - [] /bookmanage/:titleでtitle指定してDB接続ができた場合は登録されている全ての本の情報を返す
        - [] 対象が存在しなければ返り値として200ステータスとMsgを返す
- [] /bookmanage/に必要なJSONデータを持ってPOSTアクセスを行うと本の情報が登録される
    - [] Bookテーブルへのinsertが新規登録だったら新規登録をして返り値として200ステータスと新規登録したレコードを返す
    - [] Bookテーブルへのinsertが既に登録済みの場合は所有数を増やして200ステータスと新規登録したレコードが返す
    - [] Bookテーブルへのinsertが送られてきたデータの影響で処理が失敗したら返り値として400ステータスとerrorを返す
- [] /bookmanage/に必要なJSONデータを持ってPATCHアクセスを行うと本の情報が更新される
    - [] /bookmanage/:idでid指定をすると対象の本のlabelが更新される
        - [] JSONデータにlabelが含まれている場合は本のlabelが更新されれ返り値として204ステータスと更新した本の情報を返す
        - [] JSONデータにlabelが含まれていない場合は更新が行われずに返り値として200ステータスとMsgを返す
        - [] 対象が存在しなければ返り値として200ステータスとMsgを返す
        - [] 送られてきたデータの影響で処理が失敗したら返り値として400ステータスとerrorを返す
- [] /bookmanage/:idにDELETEアクセスを行うと本の情報が論理削除される
    - [] 対象が存在しなければ返り値として200ステータスとMsgを返す
    - [] 送られてきたデータの影響で処理が失敗したら返り値として400ステータスとerrorを返す

## エンティティ

```
Book テーブル
	ID          string  主キー                  // 値は→の規則で入る「split(label,2).split(3,title).insertday(dd)」
	Title       string  本のタイトル             // 値の例：　「アーキテクチャ仕様書」
	Label       string  本のラベル               // 本のジャンルやカテゴリを管理するラベル
	quantity    int     本の所有数               // 本の所有数を管理する
```
